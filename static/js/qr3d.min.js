function QRCode(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function QR8bitByte(t){this.mode=QRMode.MODE_8BIT_BYTE,this.data=t}function QRPolynomial(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=new Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function QRRSBlock(t,e){this.totalCount=t,this.dataCount=e}function QRBitBuffer(){this.buffer=[],this.length=0}THREE.OrbitControls=function(t,e){function r(){return 2*Math.PI/60/60*p.autoRotateSpeed}function o(){return Math.pow(.95,p.zoomSpeed)}function i(t){if(p.enabled!==!1){if(t.preventDefault(),t.button===p.mouseButtons.ORBIT){if(p.noRotate===!0)return;H=$.ROTATE,g.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.ZOOM){if(p.noZoom===!0)return;H=$.DOLLY,y.set(t.clientX,t.clientY)}else if(t.button===p.mouseButtons.PAN){if(p.noPan===!0)return;H=$.PAN,v.set(t.clientX,t.clientY)}H!==$.NONE&&(document.addEventListener("mousemove",n,!1),document.addEventListener("mouseup",a,!1),p.dispatchEvent(S))}}function n(t){if(p.enabled!==!1){t.preventDefault();var e=p.domElement===document?p.domElement.body:p.domElement;if(H===$.ROTATE){if(p.noRotate===!0)return;f.set(t.clientX,t.clientY),R.subVectors(f,g),p.rotateLeft(2*Math.PI*R.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*R.y/e.clientHeight*p.rotateSpeed),g.copy(f)}else if(H===$.DOLLY){if(p.noZoom===!0)return;M.set(t.clientX,t.clientY),w.subVectors(M,y),w.y>0?p.dollyIn():w.y<0&&p.dollyOut(),y.copy(M)}else if(H===$.PAN){if(p.noPan===!0)return;T.set(t.clientX,t.clientY),L.subVectors(T,v),p.pan(L.x,L.y),v.copy(T)}H!==$.NONE&&p.update()}}function a(){p.enabled!==!1&&(document.removeEventListener("mousemove",n,!1),document.removeEventListener("mouseup",a,!1),p.dispatchEvent(x),H=$.NONE)}function s(t){if(p.enabled!==!1&&p.noZoom!==!0&&H===$.NONE){t.preventDefault(),t.stopPropagation();var e=0;void 0!==t.wheelDelta?e=t.wheelDelta:void 0!==t.detail&&(e=-t.detail),e>0?p.dollyOut():0>e&&p.dollyIn(),p.update(),p.dispatchEvent(S),p.dispatchEvent(x)}}function l(t){if(!window.editMode&&p.enabled!==!1&&p.noKeys!==!0&&p.noPan!==!0)switch(t.keyCode){case p.keys.UP:p.pan(0,p.keyPanSpeed),p.update();break;case p.keys.BOTTOM:p.pan(0,-p.keyPanSpeed),p.update();break;case p.keys.LEFT:p.pan(p.keyPanSpeed,0),p.update();break;case p.keys.RIGHT:p.pan(-p.keyPanSpeed,0),p.update();break;case p.keys.W:p.rotateUp(-p.keyRotateSpeed),p.update();break;case p.keys.A:p.rotateLeft(-p.keyRotateSpeed),p.update();break;case p.keys.S:p.rotateUp(p.keyRotateSpeed),p.update();break;case p.keys.D:p.rotateLeft(p.keyRotateSpeed),p.update();break;case p.keys.Q:p.dollyOut(),p.update();break;case p.keys.E:p.dollyIn(),p.update()}}function h(t){if(p.enabled!==!1){switch(t.touches.length){case 1:if(p.noRotate===!0)return;H=$.TOUCH_ROTATE,g.set(t.touches[0].pageX,t.touches[0].pageY);break;case 2:if(p.noZoom===!0)return;H=$.TOUCH_DOLLY;var e=t.touches[0].pageX-t.touches[1].pageX,r=t.touches[0].pageY-t.touches[1].pageY,o=Math.sqrt(e*e+r*r);y.set(0,o);break;case 3:if(p.noPan===!0)return;H=$.TOUCH_PAN,v.set(t.touches[0].pageX,t.touches[0].pageY);break;default:H=$.NONE}H!==$.NONE&&p.dispatchEvent(S)}}function d(t){if(p.enabled!==!1){t.preventDefault(),t.stopPropagation();var e=p.domElement===document?p.domElement.body:p.domElement;switch(t.touches.length){case 1:if(p.noRotate===!0)return;if(H!==$.TOUCH_ROTATE)return;f.set(t.touches[0].pageX,t.touches[0].pageY),R.subVectors(f,g),p.rotateLeft(2*Math.PI*R.x/e.clientWidth*p.rotateSpeed),p.rotateUp(2*Math.PI*R.y/e.clientHeight*p.rotateSpeed),g.copy(f),p.update();break;case 2:if(p.noZoom===!0)return;if(H!==$.TOUCH_DOLLY)return;var r=t.touches[0].pageX-t.touches[1].pageX,o=t.touches[0].pageY-t.touches[1].pageY,i=Math.sqrt(r*r+o*o);M.set(0,i),w.subVectors(M,y),w.y>0?p.dollyOut():w.y<0&&p.dollyIn(),y.copy(M),p.update();break;case 3:if(p.noPan===!0)return;if(H!==$.TOUCH_PAN)return;T.set(t.touches[0].pageX,t.touches[0].pageY),L.subVectors(T,v),p.pan(L.x,L.y),v.copy(T),p.update();break;default:H=$.NONE}}}function c(){p.enabled!==!1&&(p.dispatchEvent(x),H=$.NONE)}this.object=t,this.domElement=void 0!==e?e:document,this.enabled=!0,this.needsRender=!1,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=.5,this.minDistance=400,this.maxDistance=5e3,this.minZoom=0,this.maxZoom=1/0,this.noRotate=!1,this.rotateSpeed=.7,this.keyRotateSpeed=.05,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=.03,this.maxPolarAngle=Math.PI-.03,this.minAzimuthAngle=-Math.PI/2+.03,this.maxAzimuthAngle=Math.PI/2-.03,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40,W:87,A:65,S:83,D:68,Q:81,E:69},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var u,m,p=this,E=1e-6,g=new THREE.Vector2,f=new THREE.Vector2,R=new THREE.Vector2,v=new THREE.Vector2,T=new THREE.Vector2,L=new THREE.Vector2,C=new THREE.Vector3,b=new THREE.Vector3,y=new THREE.Vector2,M=new THREE.Vector2,w=new THREE.Vector2,P=0,k=0,Q=1,A=new THREE.Vector3,B=new THREE.Vector3,q=new THREE.Quaternion,$={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},H=$.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom;var O=(new THREE.Quaternion).setFromUnitVectors(t.up,new THREE.Vector3(0,1,0)),D=O.clone().inverse(),N={type:"change"},S={type:"start"},x={type:"end"};this.rotateLeft=function(t){void 0===t&&(t=r()),k-=t},this.rotateUp=function(t){void 0===t&&(t=r()),P-=t},this.panLeft=function(t){var e=this.object.matrix.elements;C.set(e[0],e[1],e[2]),C.multiplyScalar(-t),A.add(C)},this.panUp=function(t){var e=this.object.matrix.elements;C.set(e[4],e[5],e[6]),C.multiplyScalar(t),A.add(C)},this.pan=function(t,e){var r=p.domElement===document?p.domElement.body:p.domElement;if(p.object instanceof THREE.PerspectiveCamera){var o=p.object.position,i=o.clone().sub(p.target),n=i.length();n*=Math.tan(p.object.fov/2*Math.PI/180),p.panLeft(2*t*n/r.clientHeight),p.panUp(2*e*n/r.clientHeight)}else p.object instanceof THREE.OrthographicCamera?(p.panLeft(t*(p.object.right-p.object.left)/r.clientWidth),p.panUp(e*(p.object.top-p.object.bottom)/r.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(t){void 0===t&&(t=o()),p.object instanceof THREE.PerspectiveCamera?Q/=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*t)),p.object.updateProjectionMatrix(),p.dispatchEvent(N)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.dollyOut=function(t){void 0===t&&(t=o()),p.object instanceof THREE.PerspectiveCamera?Q*=t:p.object instanceof THREE.OrthographicCamera?(p.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/t)),p.object.updateProjectionMatrix(),p.dispatchEvent(N)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")},this.update=function(){var t=this.object.position;b.copy(t).sub(this.target),b.applyQuaternion(O),u=Math.atan2(b.x,b.z),m=Math.atan2(Math.sqrt(b.x*b.x+b.z*b.z),b.y),this.autoRotate&&H===$.NONE&&this.rotateLeft(r()),u+=k,m+=P,u=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,u)),m=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,m)),m=Math.max(E,Math.min(Math.PI-E,m));var e=b.length()*Q;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(A),b.x=e*Math.sin(m)*Math.sin(u),b.y=e*Math.cos(m),b.z=e*Math.sin(m)*Math.cos(u),b.applyQuaternion(D),t.copy(this.target).add(b),this.object.lookAt(this.target),k=0,P=0,Q=1,A.set(0,0,0),(B.distanceToSquared(this.object.position)>E||8*(1-q.dot(this.object.quaternion))>E)&&(this.dispatchEvent(N),B.copy(this.object.position),q.copy(this.object.quaternion),this.needsRender=!1),this.needsRender&&(this.dispatchEvent(N),this.needsRender=!1)},this.reset=function(){H=$.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(N),this.update()},this.getPolarAngle=function(){return m},this.getAzimuthalAngle=function(){return u},this.domElement.addEventListener("contextmenu",function(t){t.preventDefault()},!1),this.domElement.addEventListener("mousedown",i,!1),this.domElement.addEventListener("mousewheel",s,!1),this.domElement.addEventListener("DOMMouseScroll",s,!1),this.domElement.addEventListener("touchstart",h,!1),this.domElement.addEventListener("touchend",c,!1),this.domElement.addEventListener("touchmove",d,!1),window.addEventListener("keydown",l,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,QRCode.prototype={addData:function(t){var e=new QR8bitByte(t);this.dataList.push(e),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw new Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},calculateMinTypeNumber:function(t){for(;40>t;t++){for(var e=QRRSBlock.getRSBlocks(t,this.errorCorrectLevel),r=new QRBitBuffer,o=0,i=0;i<e.length;i++)o+=e[i].dataCount;for(var i=0;i<this.dataList.length;i++){var n=this.dataList[i];r.put(n.mode,4),r.put(n.getLength(),QRUtil.getLengthInBits(n.mode,t)),n.write(r)}if(r.getLengthInBits()<=8*o)break}return t},make:function(){return this.typeNumber<1&&(this.typeNumber=this.calculateMinTypeNumber(1)),this.makeImpl(!1,this.getBestMaskPattern())?null:this.calculateMinTypeNumber(this.typeNumber)},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var o=0;o<this.moduleCount;o++)this.modules[r][o]=null}return this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),this.typeNumber>=7&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=QRCode.createData(this.typeNumber,this.errorCorrectLevel,this.dataList),null==this.dataCache)?!1:(this.mapData(this.dataCache,e),!0)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o?this.modules[t+r][e+o]=!0:this.modules[t+r][e+o]=!1)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=QRUtil.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){var o=t.createEmptyMovieClip(e,r),i=1;this.make();for(var n=0;n<this.modules.length;n++)for(var a=n*i,s=0;s<this.modules[n].length;s++){var l=s*i,h=this.modules[n][s];h&&(o.beginFill(0,100),o.moveTo(l,a),o.lineTo(l+i,a),o.lineTo(l+i,a+i),o.lineTo(l,a+i),o.endFill())}return o},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0);for(var e=8;e<this.moduleCount-8;e++)null==this.modules[6][e]&&(this.modules[6][e]=e%2==0)},setupPositionAdjustPattern:function(){for(var t=QRUtil.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],i=t[r];if(null==this.modules[o][i])for(var n=-2;2>=n;n++)for(var a=-2;2>=a;a++)-2==n||2==n||-2==a||2==a||0==n&&0==a?this.modules[o+n][i+a]=!0:this.modules[o+n][i+a]=!1}},setupTypeNumber:function(t){for(var e=QRUtil.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(var r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o}},setupTypeInfo:function(t,e){for(var r=this.errorCorrectLevel<<3|e,o=QRUtil.getBCHTypeInfo(r),i=0;15>i;i++){var n=!t&&1==(o>>i&1);6>i?this.modules[i][8]=n:8>i?this.modules[i+1][8]=n:this.modules[this.moduleCount-15+i][8]=n}for(var i=0;15>i;i++){var n=!t&&1==(o>>i&1);8>i?this.modules[8][this.moduleCount-i-1]=n:9>i?this.modules[8][15-i-1+1]=n:this.modules[8][15-i-1]=n}this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,i=7,n=0,a=this.moduleCount-1;a>0;a-=2)for(6==a&&a--;;){for(var s=0;2>s;s++)if(null==this.modules[o][a-s]){var l=!1;n<t.length&&(l=1==(t[n]>>>i&1));var h=QRUtil.getMask(e,o,a-s);h&&(l=!l),this.modules[o][a-s]=l,i--,-1==i&&(n++,i=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},QRCode.PAD0=236,QRCode.PAD1=17,QRCode.createData=function(t,e,r){for(var o=QRRSBlock.getRSBlocks(t,e),i=new QRBitBuffer,n=0;n<r.length;n++){var a=r[n];i.put(a.mode,4),i.put(a.getLength(),QRUtil.getLengthInBits(a.mode,t)),a.write(i)}for(var s=0,n=0;n<o.length;n++)s+=o[n].dataCount;if(i.getLengthInBits()>8*s)return null;for(i.getLengthInBits()+4<=8*s&&i.put(0,4);i.getLengthInBits()%8!=0;)i.putBit(!1);for(;;){if(i.getLengthInBits()>=8*s)break;if(i.put(QRCode.PAD0,8),i.getLengthInBits()>=8*s)break;i.put(QRCode.PAD1,8)}return QRCode.createBytes(i,o)},QRCode.createBytes=function(t,e){for(var r=0,o=0,i=0,n=new Array(e.length),a=new Array(e.length),s=0;s<e.length;s++){var l=e[s].dataCount,h=e[s].totalCount-l;o=Math.max(o,l),i=Math.max(i,h),n[s]=new Array(l);for(var d=0;d<n[s].length;d++)n[s][d]=255&t.buffer[d+r];r+=l;var c=QRUtil.getErrorCorrectPolynomial(h),u=new QRPolynomial(n[s],c.getLength()-1),m=u.mod(c);a[s]=new Array(c.getLength()-1);for(var d=0;d<a[s].length;d++){var p=d+m.getLength()-a[s].length;a[s][d]=p>=0?m.get(p):0}}for(var E=0,d=0;d<e.length;d++)E+=e[d].totalCount;for(var g=new Array(E),f=0,d=0;o>d;d++)for(var s=0;s<e.length;s++)d<n[s].length&&(g[f++]=n[s][d]);for(var d=0;i>d;d++)for(var s=0;s<e.length;s++)d<a[s].length&&(g[f++]=a[s][d]);return g},QR8bitByte.prototype={getLength:function(t){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}};for(var QRMode={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},QRErrorCorrectLevel={L:1,M:0,Q:3,H:2},QRMaskPattern={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},QRUtil={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;QRUtil.getBCHDigit(e)-QRUtil.getBCHDigit(QRUtil.G15)>=0;)e^=QRUtil.G15<<QRUtil.getBCHDigit(e)-QRUtil.getBCHDigit(QRUtil.G15);return(t<<10|e)^QRUtil.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;QRUtil.getBCHDigit(e)-QRUtil.getBCHDigit(QRUtil.G18)>=0;)e^=QRUtil.G18<<QRUtil.getBCHDigit(e)-QRUtil.getBCHDigit(QRUtil.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return QRUtil.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case QRMaskPattern.PATTERN000:return(e+r)%2==0;case QRMaskPattern.PATTERN001:return e%2==0;case QRMaskPattern.PATTERN010:return r%3==0;case QRMaskPattern.PATTERN011:return(e+r)%3==0;case QRMaskPattern.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case QRMaskPattern.PATTERN101:return e*r%2+e*r%3==0;case QRMaskPattern.PATTERN110:return(e*r%2+e*r%3)%2==0;case QRMaskPattern.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new QRPolynomial([1],0),r=0;t>r;r++)e=e.multiply(new QRPolynomial([1,QRMath.gexp(r)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case QRMode.MODE_NUMBER:return 10;case QRMode.MODE_ALPHA_NUM:return 9;case QRMode.MODE_8BIT_BYTE:return 8;case QRMode.MODE_KANJI:return 8;default:throw new Error("mode:"+t)}else if(27>e)switch(t){case QRMode.MODE_NUMBER:return 12;case QRMode.MODE_ALPHA_NUM:return 11;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 10;default:throw new Error("mode:"+t)}else{if(!(41>e))throw new Error("type:"+e);switch(t){case QRMode.MODE_NUMBER:return 14;case QRMode.MODE_ALPHA_NUM:return 13;case QRMode.MODE_8BIT_BYTE:return 16;case QRMode.MODE_KANJI:return 12;default:throw new Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var i=0;e>i;i++){for(var n=0,a=t.isDark(o,i),s=-1;1>=s;s++)if(!(0>o+s||o+s>=e))for(var l=-1;1>=l;l++)0>i+l||i+l>=e||(0!=s||0!=l)&&a==t.isDark(o+s,i+l)&&n++;n>5&&(r+=3+n-5)}for(var o=0;e-1>o;o++)for(var i=0;e-1>i;i++){var h=0;t.isDark(o,i)&&h++,t.isDark(o+1,i)&&h++,t.isDark(o,i+1)&&h++,t.isDark(o+1,i+1)&&h++,(0==h||4==h)&&(r+=3)}for(var o=0;e>o;o++)for(var i=0;e-6>i;i++)t.isDark(o,i)&&!t.isDark(o,i+1)&&t.isDark(o,i+2)&&t.isDark(o,i+3)&&t.isDark(o,i+4)&&!t.isDark(o,i+5)&&t.isDark(o,i+6)&&(r+=40);for(var i=0;e>i;i++)for(var o=0;e-6>o;o++)t.isDark(o,i)&&!t.isDark(o+1,i)&&t.isDark(o+2,i)&&t.isDark(o+3,i)&&t.isDark(o+4,i)&&!t.isDark(o+5,i)&&t.isDark(o+6,i)&&(r+=40);for(var d=0,i=0;e>i;i++)for(var o=0;e>o;o++)t.isDark(o,i)&&d++;var c=Math.abs(100*d/e/e-50)/5;return r+=10*c}},QRMath={glog:function(t){if(1>t)throw new Error("glog("+t+")");return QRMath.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return QRMath.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},i=0;8>i;i++)QRMath.EXP_TABLE[i]=1<<i;for(var i=8;256>i;i++)QRMath.EXP_TABLE[i]=QRMath.EXP_TABLE[i-4]^QRMath.EXP_TABLE[i-5]^QRMath.EXP_TABLE[i-6]^QRMath.EXP_TABLE[i-8];for(var i=0;255>i;i++)QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]]=i;QRPolynomial.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var o=0;o<t.getLength();o++)e[r+o]^=QRMath.gexp(QRMath.glog(this.get(r))+QRMath.glog(t.get(o)));return new QRPolynomial(e,0)},mod:function(t){if(this.getLength()-t.getLength()<0)return this;for(var e=QRMath.glog(this.get(0))-QRMath.glog(t.get(0)),r=new Array(this.getLength()),o=0;o<this.getLength();o++)r[o]=this.get(o);for(var o=0;o<t.getLength();o++)r[o]^=QRMath.gexp(QRMath.glog(t.get(o))+e);return new QRPolynomial(r,0).mod(t)}},QRRSBlock.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],QRRSBlock.getRSBlocks=function(t,e){var r=QRRSBlock.getRsBlockTable(t,e);if(void 0==r)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=r.length/3,i=[],n=0;o>n;n++)for(var a=r[3*n+0],s=r[3*n+1],l=r[3*n+2],h=0;a>h;h++)i.push(new QRRSBlock(s,l));return i},QRRSBlock.getRsBlockTable=function(t,e){switch(e){case QRErrorCorrectLevel.L:return QRRSBlock.RS_BLOCK_TABLE[4*(t-1)+0];case QRErrorCorrectLevel.M:return QRRSBlock.RS_BLOCK_TABLE[4*(t-1)+1];case QRErrorCorrectLevel.Q:return QRRSBlock.RS_BLOCK_TABLE[4*(t-1)+2];case QRErrorCorrectLevel.H:return QRRSBlock.RS_BLOCK_TABLE[4*(t-1)+3];default:return void 0}},QRBitBuffer.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},function(){"use strict";var t,e;t=function(){function t(t,e,r){var o,i;this.container=$("#WebGLContainer"),i=this.container.width(),o=this.container.height(),this.camera=new THREE.PerspectiveCamera(27,i/o,1,5e3),this.camera.position.z=600,this.controls=new THREE.OrbitControls(this.camera,this.container[0]),this.controls.addEventListener("change",function(t){return function(){return t.render()}}(this)),this.scene=new THREE.Scene,this.ambientLight=new THREE.AmbientLight(8947848),this.scene.add(this.ambientLight),this.directionalLight=new THREE.DirectionalLight(4473924,.1),this.directionalLight.position.set(0,0,1),this.scene.add(this.directionalLight),this.cameraPointLight=new THREE.PointLight(8947848,0,700),this.camera.add(this.cameraPointLight),this.scene.add(this.camera),this.pointLight=new THREE.PointLight(8947848,0,700),this.pointLight.position.set(100,100,500),this.scene.add(this.pointLight),this.createBufferGeo(t,e,r),this.meshPhongMaterial=new THREE.MeshPhongMaterial({color:14540253,emissive:0,specular:8947848,shininess:50,vertexColors:THREE.VertexColors}),this.meshLambertMaterial=new THREE.MeshLambertMaterial({color:14540253,emissive:0,vertexColors:THREE.VertexColors}),this.meshBasicMaterial=new THREE.MeshBasicMaterial({color:14540253,vertexColors:THREE.VertexColors}),this.qrmaterial=this.meshPhongMaterial,this.qrmesh=new THREE.Mesh(this.qrgeo,this.qrmaterial),this.scene.add(this.qrmesh),this.renderer=new THREE.WebGLRenderer({antialias:r.antialias}),this.renderer.setClearColor(new THREE.Color(r.backColor).getHex()),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(i,o),this.renderer.gammaInput=!0,this.renderer.gammaOutput=!0,this.stats=Stats(),this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="0px",this.container.append(this.renderer.domElement),this.container.append(this.stats.domElement),window.addEventListener("resize",function(t){return function(e){return t.onWindowResize(e)}}(this)),this.controls.needsRender=!0,this.animate()}return t.prototype.createBufferGeo=function(t,e,r){var o,i,n,a,s,l,h,d,c,u,m,p,E,g,f,R;for(this.qrgeo=new THREE.BufferGeometry,p=new Float32Array(e*e*12),i=new Float32Array(e*e*12),m=new Float32Array(e*e*12),s=new Uint32Array(e*e*6),a=l=h=0,n=new THREE.Color(r.darkColor),c=new THREE.Color(r.lightColor),R=d=0,E=e;E>d;R=d+=1)for(f=u=0,g=e;g>u;f=u+=1)p[a]=f/e*200-100,p[a+1]=R/e*-200+100,p[a+2]=0,p[a+3]=(f+1)/e*200-100,p[a+4]=R/e*-200+100,p[a+5]=0,p[a+6]=(f+1)/e*200-100,p[a+7]=(R+1)/e*-200+100,p[a+8]=0,p[a+9]=f/e*200-100,p[a+10]=(R+1)/e*-200+100,p[a+11]=0,o=t[R][f]?n:c,i[a]=i[a+3]=i[a+6]=i[a+9]=o.r,i[a+1]=i[a+4]=i[a+7]=i[a+10]=o.g,i[a+2]=i[a+5]=i[a+8]=i[a+11]=o.b,m[a]=m[a+3]=m[a+6]=m[a+9]=0,m[a+1]=m[a+4]=m[a+7]=m[a+10]=0,m[a+2]=m[a+5]=m[a+8]=m[a+11]=1,s[l]=s[l+4]=h+3,s[l+1]=s[l+3]=h+1,s[l+2]=h,s[l+5]=h+2,a+=12,l+=6,h+=4;return this.qrgeo.addAttribute("position",new THREE.BufferAttribute(p,3)),this.qrgeo.addAttribute("color",new THREE.BufferAttribute(i,3)),this.qrgeo.addAttribute("normal",new THREE.BufferAttribute(m,3)),this.qrgeo.addAttribute("index",new THREE.BufferAttribute(s,1)),this.qrgeo.computeBoundingSphere()},t.prototype.onWindowResize=function(){var t,e;return e=this.container.width(),t=this.container.height(),this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t),this.render()},t.prototype.animate=function(){return requestAnimationFrame(function(t){return function(){return t.animate()}}(this)),this.controls.update(),this.stats.update()},t.prototype.render=function(){return this.renderer.render(this.scene,this.camera)},t.prototype.exportPng=function(){return this.renderer.render(this.scene,this.camera),window.open(this.renderer.domElement.toDataURL(),"Exported png")},t}(),$("#qrModal").modal({backdrop:"static",keyboard:!1}),$("#generateQR").click(function(){var e,r,o,i;return e=function(){switch($("#qrEcl").val()){case"0":return QRErrorCorrectLevel.L;case"1":return QRErrorCorrectLevel.M;case"2":return QRErrorCorrectLevel.Q;case"3":return QRErrorCorrectLevel.H}}(),o=new QRCode(parseInt($("#qrType").val()),e),o.addData($("#qrText").val()),i=o.make(),null===i?(r={lightColor:$("#qrLightColor").val(),darkColor:$("#qrDarkColor").val(),backColor:$("#qrBackColor").val(),antialias:"0"===$("#qrAntialias").val()},window.qr3d=new t(o.modules,o.moduleCount,r),$("#qrModal").modal("hide"),$("#editQrType").val($("#qrType").val()),$("#editQrEcl").val($("#qrEcl").val()),$("#editDarkColor").val($("#qrDarkColor").val()),$("#editLightColor").val($("#qrLightColor").val()),$("#editBackColor").val($("#qrBackColor").val()),$("#editQrText").val($("#qrText").val())):(alert("Error: Text is to long for selected type. The minimal type for the selected text is: "+i),$("#qrType").val(i))}),$("#exportPng").click(function(){return window.qr3d.exportPng()}),window.editMode=!1,$("#showEdit, #closeEdit").click(function(){return window.editMode=!window.editMode,window.editMode?($("#showEdit").addClass("active"),$("#showEdit").children("a").text("Hide edit scene configuration menu"),$("#WebGLContainer").css("right","500px"),qr3d.onWindowResize(),$("#editMenu").show()):($("#showEdit").removeClass("active"),$("#showEdit").children("a").text("Show edit scene configuration menu"),$("#WebGLContainer").css("right","0px"),qr3d.onWindowResize(),$("#editMenu").hide())}),$("#changeQRcode").click(function(){var t,e,r,o;return t=function(){switch($("#editQrEcl").val()){case"0":return QRErrorCorrectLevel.L;case"1":return QRErrorCorrectLevel.M;case"2":return QRErrorCorrectLevel.Q;case"3":return QRErrorCorrectLevel.H}}(),r=new QRCode(parseInt($("#editQrType").val()),t),r.addData($("#editQrText").val()),o=r.make(),null===o?(e={lightColor:$("#editLightColor").val(),darkColor:$("#editDarkColor").val()},qr3d.createBufferGeo(r.modules,r.moduleCount,e),qr3d.scene.remove(qr3d.qrmesh),qr3d.qrmesh=new THREE.Mesh(qr3d.qrgeo,qr3d.qrmaterial),qr3d.scene.add(qr3d.qrmesh),qr3d.controls.needsRender=!0):(alert("Error: Text is to long for selected type. The minimal type for the selected text is: "+o),$("#editQrType").val(o))}),$("#editBackColor").change(function(){return qr3d.renderer.setClearColor(new THREE.Color($(this).val()).getHex()),qr3d.controls.needsRender=!0}),$("#editMaterial").val("0").change(function(){switch($(this).val()){case"0":qr3d.qrmaterial=qr3d.meshPhongMaterial,qr3d.qrmaterial.emissive=new THREE.Color($("#editEmissiveColor").val()),qr3d.qrmaterial.specular=new THREE.Color($("#editSpecularColor").val()),qr3d.qrmaterial.shininess=parseFloat($("#editShininess").val()),$("#editEmissiveColor").prop("disabled",!1),$("#editSpecularColor").prop("disabled",!1),$("#editShininess").prop("disabled",!1);break;case"1":qr3d.qrmaterial=qr3d.meshLambertMaterial,qr3d.qrmaterial.emissive=new THREE.Color($("#editEmissiveColor").val()),$("#editEmissiveColor").prop("disabled",!1),$("#editSpecularColor").prop("disabled",!0),$("#editShininess").prop("disabled",!0);break;case"2":qr3d.qrmaterial=qr3d.meshBasicMaterial,$("#editEmissiveColor").prop("disabled",!0),$("#editSpecularColor").prop("disabled",!0),$("#editShininess").prop("disabled",!0)}return qr3d.qrmaterial.color=new THREE.Color($("#editDiffuseColor").val()),qr3d.qrmesh.material=qr3d.qrmaterial,qr3d.controls.needsRender=!0}),$("#editDiffuseColor").val("#dddddd").change(function(){return qr3d.qrmaterial.color=new THREE.Color($(this).val()),qr3d.controls.needsRender=!0}),$("#editEmissiveColor").val("#000000").change(function(){return qr3d.qrmaterial.emissive=new THREE.Color($(this).val()),qr3d.controls.needsRender=!0}),$("#editSpecularColor").val("#888888").change(function(){return qr3d.qrmaterial.specular=new THREE.Color($(this).val()),qr3d.controls.needsRender=!0}),$("#editShininess").val(50).change(function(){return qr3d.qrmaterial.shininess=parseFloat($(this).val()),qr3d.controls.needsRender=!0}),$("#editAmbientLightColor").val("#888888").change(function(){return qr3d.ambientLight.color=new THREE.Color($(this).val()),qr3d.controls.needsRender=!0}),$("#editEnableDirLight").prop("checked",!0).change(function(){return $(this).prop("checked")?qr3d.directionalLight.intensity=parseFloat($("#editDirLightIntensity").val()):qr3d.directionalLight.intensity=0,qr3d.controls.needsRender=!0}),$("#editDirLightColor").val("#444444").change(function(){return qr3d.directionalLight.color=new THREE.Color($(this).val()),qr3d.controls.needsRender=!0}),$("#editDirLightIntensity").val(.1).change(function(){return qr3d.directionalLight.intensity=parseFloat($(this).val()),qr3d.controls.needsRender=!0}),$("#editDirLightX").val(0),$("#editDirLightY").val(0),$("#editDirLightZ").val(1),$("#editDirLightVector").click(function(){var t,e,r;return t=parseFloat($("#editDirLightX").val()),e=parseFloat($("#editDirLightY").val()),r=parseFloat($("#editDirLightZ").val()),qr3d.directionalLight.position.set(t,e,r).normalize(),qr3d.controls.needsRender=!0}),$("#editEnableCamLight").prop("checked",!1).change(function(){return $(this).prop("checked")?qr3d.cameraPointLight.intensity=parseFloat($("#editCameraLightIntensity").val()):qr3d.cameraPointLight.intensity=0,qr3d.controls.needsRender=!0}),$("#editCameraLightColor").val("#888888").change(function(){return qr3d.cameraPointLight.color=new THREE.Color($(this).val()),
qr3d.controls.needsRender=!0}),$("#editCameraLightIntensity").val(.7).change(function(){return qr3d.cameraPointLight.intensity=parseFloat($(this).val()),qr3d.controls.needsRender=!0}),$("#editCameraLightDistance").val(700).change(function(){return qr3d.cameraPointLight.distance=parseFloat($(this).val()),qr3d.controls.needsRender=!0}),$("#editEnablePointLight").prop("checked",!1).change(function(){return $(this).prop("checked")?qr3d.pointLight.intensity=parseFloat($("#editPointLightIntensity").val()):qr3d.pointLight.intensity=0,qr3d.controls.needsRender=!0}),$("#editPointLightColor").val("#888888").change(function(){return qr3d.pointLight.color=new THREE.Color($(this).val()),qr3d.controls.needsRender=!0}),$("#editPointLightIntensity").val(.3).change(function(){return qr3d.pointLight.intensity=parseFloat($(this).val()),qr3d.controls.needsRender=!0}),$("#editPointLightDistance").val(700).change(function(){return qr3d.pointLight.distance=parseFloat($(this).val()),qr3d.controls.needsRender=!0}),$("#editPointLightX").val(100),$("#editPointLightY").val(100),$("#editPointLightZ").val(500),$("#editPointLightPosition").click(function(){var t,e,r;return t=parseFloat($("#editPointLightX").val()),e=parseFloat($("#editPointLightY").val()),r=parseFloat($("#editPointLightZ").val()),qr3d.pointLight.position.set(t,e,r),qr3d.controls.needsRender=!0}),e=null,$("#editObstacleWidth").val(50),$("#editObstacleHeight").val(50),$("#editObstacleColor").val("#FF0000"),$("#editObstacleX").val(30),$("#editObstacleY").val(30),$("#editObstacleZ").val(100),$("#addObstacle").click(function(){var t,r,o,i,n,a,s,l,h,d;return null!=e?(qr3d.scene.remove(e),qr3d.controls.needsRender=!0,e=null,$(this).text("Add obstacle")):(s=parseFloat($("#editObstacleWidth").val()),r=parseFloat($("#editObstacleHeight").val()),t=new THREE.Color($("#editObstacleColor").val()).getHex(),l=parseFloat($("#editObstacleX").val()),h=parseFloat($("#editObstacleY").val()),d=parseFloat($("#editObstacleZ").val()),n=new THREE.BufferGeometry,a=new Float32Array(12),i=new Float32Array(12),o=new Uint32Array(6),a[0]=l-s/2,a[1]=h+r/2,a[2]=d,a[3]=l+s/2,a[4]=h+r/2,a[5]=d,a[6]=l+s/2,a[7]=h-r/2,a[8]=d,a[9]=l-s/2,a[10]=h-r/2,a[11]=d,i[0]=i[3]=i[6]=i[9]=i[1]=i[4]=i[7]=i[10]=0,i[2]=i[5]=i[8]=i[11]=1,o[0]=o[4]=3,o[1]=o[3]=1,o[2]=0,o[5]=2,n.addAttribute("position",new THREE.BufferAttribute(a,3)),n.addAttribute("normal",new THREE.BufferAttribute(i,3)),n.addAttribute("index",new THREE.BufferAttribute(o,1)),n.computeBoundingSphere(),e=new THREE.Mesh(n,new THREE.MeshBasicMaterial({color:t})),qr3d.scene.add(e),qr3d.controls.needsRender=!0,$(this).text("Remove obstacle"))})}.call(this);